"0","#loading credit data"
"0","credit.xy <- read.table(""data/credit_data.txt"", header = TRUE)"
"0","dim(credit.xy)"
"1","[1]"
"1"," 885"
"1","  15"
"1","
"
"0","set.seed(123)"
"0","#selecting 80% of data as training data"
"0","train <- sample(1:885, 0.8*885)"
"0","#showing the number of cases per class for both training and test data"
"0","table(credit.xy$Fail[train])"
"1","
"
"1","  0 "
"1","  1 "
"1","
"
"1","547 "
"1","161 "
"1","
"
"0","table(credit.xy$Fail[-train])"
"1","
"
"1","  0 "
"1","  1 "
"1","
"
"1","146 "
"1"," 31 "
"1","
"
"0","#(a)"
"0","#fitting logistic regression to training data and creating summary data"
"0","credit.glm <- glm(Fail~.-Id, family = binomial, data = credit.xy[train,])"
"0","summary(credit.glm)"
"1","
Call:
"
"1","glm(formula = Fail ~ . - Id, family = binomial, data = credit.xy[train, 
    ])"
"1","

"
"1","Deviance Residuals: 
"
"1","     Min  "
"1","      1Q  "
"1","  Median  "
"1","      3Q  "
"1","     Max  "
"1","
"
"1","-2.00600  "
"1","-0.59629  "
"1","-0.29571  "
"1","-0.02315  "
"1"," 2.42949  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1","  -3.495673"
"1","   0.854985"
"1","  -4.089"
"1"," 4.34e-05"
"1"," ***"
"1","
Leverage   "
"1","  -0.380287"
"1","   0.253589"
"1","  -1.500"
"1"," 0.133713"
"1","    "
"1","
CumulProfit"
"1","  -2.373825"
"1","   0.725865"
"1","  -3.270"
"1"," 0.001074"
"1"," ** "
"1","
Liquid     "
"1"," -14.881906"
"1","   3.528628"
"1","  -4.217"
"1"," 2.47e-05"
"1"," ***"
"1","
OverDueDebt"
"1","   1.746010"
"1","   0.312334"
"1","   5.590"
"1"," 2.27e-08"
"1"," ***"
"1","
WorkCap    "
"1","  -1.642276"
"1","   0.589250"
"1","  -2.787"
"1"," 0.005319"
"1"," ** "
"1","
OperProfit "
"1","  -0.624649"
"1","   0.926995"
"1","  -0.674"
"1"," 0.500411"
"1","    "
"1","
ShortDebt  "
"1","   2.405079"
"1","   0.646639"
"1","   3.719"
"1"," 0.000200"
"1"," ***"
"1","
GuarDebt   "
"1","  -1.060947"
"1","   0.454228"
"1","  -2.336"
"1"," 0.019506"
"1"," *  "
"1","
StateLag   "
"1","   0.007791"
"1","   0.002092"
"1","   3.724"
"1"," 0.000196"
"1"," ***"
"1","
FiscalLag  "
"1","  -0.004302"
"1","   0.003036"
"1","  -1.417"
"1"," 0.156519"
"1","    "
"1","
InFinan    "
"1","  -0.217202"
"1","   0.497453"
"1","  -0.437"
"1"," 0.662380"
"1","    "
"1","
Links      "
"1","   6.302690"
"1","   2.497104"
"1","   2.524"
"1"," 0.011603"
"1"," *  "
"1","
CapStruct  "
"1","   2.277517"
"1","   0.769851"
"1","   2.958"
"1"," 0.003093"
"1"," ** "
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1","binomial"
"1"," family taken to be "
"1","1"
"1",")

"
"1","    Null deviance: 759.14  on 707  degrees of freedom
"
"1","Residual deviance: 507.07  on 694  degrees of freedom
"
"1","AIC: "
"1","535.07"
"1","

"
"1","Number of Fisher Scoring iterations: "
"1","7"
"1","
"
"1","
"
"0","#predicting if a firm will go bankrupt if the predicted probability is "
"0","#P(Y=1|X=x) of bankruptcy is 0.5 or greater and creating a confusion matrix"
"0","yHat <- predict(credit.glm , credit.xy[-train, c(1,3:15)], type = ""response"")"
"0","table(credit.xy$Fail[-train], yHat >= 0.5)"
"1","   
"
"1","   "
"1"," FALSE"
"1"," TRUE"
"1","
  0"
"1","   136"
"1","   10"
"1","
  1"
"1","    17"
"1","   14"
"1","
"
